# äº‘ç«¯æ•°æ®åº“ç´§æ€¥ä¿®å¤æŒ‡å—

## ğŸš¨ **å½“å‰çŠ¶å†µ**
- æ•°æ®åº“ç›®å½•å­˜åœ¨ä½†ä¸ºç©ºï¼ˆ0ä¸ªé›†åˆï¼Œ0ä¸ªæ–‡æ¡£ï¼‰
- éœ€è¦ä»JSONæ–‡ä»¶é‡æ–°å¯¼å…¥æ•°æ®

## ğŸ”§ **ç«‹å³ä¿®å¤æ­¥éª¤**

### **æ­¥éª¤1ï¼šè·å–æœ€æ–°ä¿®å¤å·¥å…·**
```bash
git pull origin cloud-deployment
```

### **æ­¥éª¤2ï¼šæ£€æŸ¥JSONæ–‡ä»¶**
```bash
# æ£€æŸ¥JSONæ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -la db_export.json

# æŸ¥çœ‹æ–‡ä»¶å¤§å°ï¼ˆåº”è¯¥çº¦32MBï¼‰
du -h db_export.json
```

### **æ­¥éª¤3ï¼šè¿è¡Œä¿®å¤è„šæœ¬**
```bash
# è¿è¡Œä¿®å¤è„šæœ¬ï¼ˆç°åœ¨ä¼šæ­£ç¡®è¯†åˆ«ç©ºæ•°æ®åº“ï¼‰
python fix_db_compatibility.py
```

**é¢„æœŸè¾“å‡º**ï¼š
```
ğŸš€ å¼€å§‹æ•°æ®åº“å…¼å®¹æ€§ä¿®å¤...
ğŸ” æ£€æŸ¥æ•°æ®åº“å…¼å®¹æ€§...
âš ï¸  æ•°æ®åº“ä¸ºç©ºï¼Œæ²¡æœ‰ä»»ä½•é›†åˆ
ğŸ“¦ å¤‡ä»½æ•°æ®åº“åˆ°: db_backup_xxxxx
ğŸ“ å‘ç°JSONå¯¼å‡ºæ–‡ä»¶ï¼Œå°è¯•å¯¼å…¥...
ğŸ”§ åˆ›å»ºå…¼å®¹çš„ç©ºæ•°æ®åº“ç»“æ„...
âœ… åˆ›å»ºé›†åˆ: knowledge_base_min_shi_an_li
âœ… åˆ›å»ºé›†åˆ: knowledge_base_xing_shi_an_li
...
ğŸ“¥ ä»JSONå¯¼å…¥æ•°æ®...
ğŸ“Š å¯¼å…¥ä¿¡æ¯:
   - æºå¹³å°: macOS_M4
   - å¯¼å‡ºæ—¶é—´: 2025-05-27T09:34:40.371358
   - æ€»æ–‡æ¡£æ•°: 4325
ğŸ“¥ å¯¼å…¥é›†åˆ: knowledge_base_min_shi_an_li
âœ… å¯¼å…¥ 2046 ä¸ªæ–‡æ¡£åˆ° knowledge_base_min_shi_an_li
...
âœ… JSONæ•°æ®å¯¼å…¥å®Œæˆï¼Œæ€»è®¡å¯¼å…¥ 4325 ä¸ªæ–‡æ¡£
ğŸ‰ æ•°æ®åº“å…¼å®¹æ€§ä¿®å¤å®Œæˆï¼
âœ… ä¿®å¤éªŒè¯æˆåŠŸ
```

### **æ­¥éª¤4ï¼šéªŒè¯ä¿®å¤ç»“æœ**
```bash
# éªŒè¯æ•°æ®åº“çŠ¶æ€
python -c "
import chromadb
client = chromadb.PersistentClient(path='db/')
collections = client.list_collections()
print(f'é›†åˆæ•°é‡: {len(collections)}')
total = 0
for col in collections:
    count = client.get_collection(col.name).count()
    print(f'{col.name}: {count} ä¸ªæ–‡æ¡£')
    total += count
print(f'æ€»è®¡: {total} ä¸ªæ–‡æ¡£')
"
```

**é¢„æœŸç»“æœ**ï¼š
```
é›†åˆæ•°é‡: 5
knowledge_base_min_shi_an_li: 2046 ä¸ªæ–‡æ¡£
knowledge_base_xing_shi_an_li: 1524 ä¸ªæ–‡æ¡£
knowledge_base_xing_zheng_an_li: 533 ä¸ªæ–‡æ¡£
knowledge_base_zhi_xing_an_li: 178 ä¸ªæ–‡æ¡£
knowledge_base_guo_jia_pei_chang_an_li: 44 ä¸ªæ–‡æ¡£
æ€»è®¡: 4325 ä¸ªæ–‡æ¡£
```

### **æ­¥éª¤5ï¼šå¯åŠ¨æœåŠ¡**
```bash
# å¯åŠ¨äº‘ç«¯æœåŠ¡
python app_cloud.py
```

### **æ­¥éª¤6ï¼šæµ‹è¯•åŠŸèƒ½**
```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:5000/health

# æµ‹è¯•æœç´¢
curl -X POST http://localhost:5000/search \
  -F "query=åˆåŒçº çº·" \
  -F "case_type_folder=æ°‘äº‹æ¡ˆä¾‹"
```

## ğŸ” **æ•…éšœæ’é™¤**

### **å¦‚æœJSONæ–‡ä»¶ä¸å­˜åœ¨**
```bash
# æ£€æŸ¥æ˜¯å¦æœ‰JSONæ–‡ä»¶
ls -la *.json

# å¦‚æœæ²¡æœ‰ï¼Œéœ€è¦ä»æœ¬åœ°é‡æ–°ä¸Šä¼ 
# åœ¨æœ¬åœ°æ‰§è¡Œï¼špython export_db_to_json.py
# ç„¶åä¸Šä¼  db_export.json åˆ°äº‘ç«¯
```

### **å¦‚æœå¯¼å…¥å¤±è´¥**
```bash
# æ£€æŸ¥JSONæ–‡ä»¶æ ¼å¼
python -c "
import json
with open('db_export.json', 'r') as f:
    data = json.load(f)
print('JSONæ–‡ä»¶æ ¼å¼æ­£ç¡®')
print(f'é›†åˆæ•°é‡: {len([k for k in data.keys() if k != \"_metadata\"])}')
print(f'å…ƒæ•°æ®: {data.get(\"_metadata\", {})}')
"
```

### **å¦‚æœæœåŠ¡å¯åŠ¨å¤±è´¥**
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tlnp | grep :5000

# æ€æ­»å ç”¨è¿›ç¨‹
pkill -f app_cloud

# é‡æ–°å¯åŠ¨
python app_cloud.py
```

## ğŸ“‹ **å®Œæˆæ£€æŸ¥æ¸…å•**

- [ ] JSONæ–‡ä»¶å­˜åœ¨ä¸”å¤§å°æ­£ç¡®ï¼ˆ~32MBï¼‰
- [ ] ä¿®å¤è„šæœ¬æˆåŠŸè¿è¡Œ
- [ ] æ•°æ®åº“åŒ…å«5ä¸ªé›†åˆ
- [ ] æ€»æ–‡æ¡£æ•°ä¸º4325ä¸ª
- [ ] æœåŠ¡æˆåŠŸå¯åŠ¨
- [ ] å¥åº·æ£€æŸ¥é€šè¿‡
- [ ] æœç´¢åŠŸèƒ½æ­£å¸¸

## ğŸ¯ **é¢„æœŸæ—¶é—´**
æ•´ä¸ªä¿®å¤è¿‡ç¨‹åº”è¯¥åœ¨5-10åˆ†é’Ÿå†…å®Œæˆã€‚ 